# Webdriver.io tests

Тестовый проект на Webdriver.io и Codecept.js со множеством вспомогательных функций

## Установка

Установить зависимости и локальный сервер selenium-standalone 
```
npm run deploy
```

Установить зависимости без сервера selenium-standalone 
```
npm install
```

## Запуск тестов

Запуск тестов производит файл helpers/run.js
```
node helpers/run.js run --config ./my_config.json
```
### Опции командной строки
```-c, --config [file] ```- обязательная опция, задает конфиг для тестов

```-o, --override [value]``` - необязательная опция. Позволяет динамически перезаписывать параметры конфига

```-a, --async``` - необязательная опция. Запускает сценарии одновременно.

### Опции конфигурационного файла

Основные параметры
```
{
  "output": "./output", //Путь для папки со скриншотами. При задании этой опции сюда будут помещаться скриншоты ошибочных тестов, 
                        //помимо записи в allure
  "helpers": {
    "WebDriverIO": {
      "url": "https://demo-merchant.xsolla.com", //Домен по умолчанию. 
                                                 //Команды, не содержащие домена будут открывать страницы с этим доменом
      "browser": "chrome", //Браузер для выполнения тестов
      "smartWait": 30001, //Время ожидания элемента по умолчанию, перед выполнением команды 
      "waitForTimeout": 30001, //Время ожидания элемента по умолчанию, для команды ожидания элемента
      "host": "localhost", //Домен сервера вебдрайвера. Можно задать так же наш адрес selenium grid: seleniumgrid.srv.local
      "port": "4444", //Порт сервера вебдрайвера
      "path": "/wd/hub", //Страница инициализации сервера вебдрайвера
      "desiredCapabilities": { //Дополнительные опции для браузеров
        "chromeOptions": { //опции для хрома
          "args": [ "--headless", "--disable-gpu", "--window-size=1920,1080" ] //Опции --headless, --disable-gpu" для отключения вьюпорта браузера
                                                                               //Опция "--window-size=1920,1080"  задает разрешение окна браузера
        }
      }
    }
  },
  "include": { // позволяет подключать к тестовым сценариям собственные команды
    "I": "./steps/steps_file.js", //некоторые команды-хэлперы
    "service": "./steps/service.js" //сервисные команды. Содержит команду логина, 
    //читающую сценарий логина из параметра loginScript конфига.
    //При задании опции асинхронного запуска, этот хэлпер позволяет выполнять сценарий логина 
    //только один раз, перед запуском асинхронных тестов.
    //При выполнении сценариев синхронно, этот хэлпер выполняет сценарий логина перед каждым тестом.
    //Таким образом реализуется асинхронный запуск тестов, без необходимости изменения самих файлов тестов.
  },
  "bootstrap": "./helpers/eventsHandler.js", // Этот файл выполнится перед запуском тестов
  "teardown": null, // Этот файл выполнится после запуска тестов
  "hooks": [],  //Хуки. Эта опция похожа на bootstrap и teardown, 
                //но позволяет регистрировать множество файлов для подключения к диспетчеру ивентов codecept.js
  "tests": "./tests/demo_publisher/demo_publisher_*", //Сценарии тестов. 
  "timeout": 36000, //После этого времени кодцепт остановит выполнение сценария с ошибкой. 
                    //Не позволяет тестам зависать навсегда 
  "name": "publisher 3", //Имя тестового наборта
  "loginScript": "./tests/demo_publisher/login_partition.js" //сценарий логина. 
  //Позволяет использовать один сценарий логина для синхронных и асинхронных тестов.
  //Необязательный параметр. Можно реализовать собственные сценарии логина в тестах
}
```

Остальные параметры описаны здесь https://codecept.io/configuration/
Пример конфигурационного файла можно посмотреть в файле example_demo_publisher3.json